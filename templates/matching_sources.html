{% extends "layout.html" %} {% block body %}

<div class="container">
    <h1 class="title section-title">{{page_title}}</h1>

    <hr>

    <form method="post">
        <div class="row">
            <div class="col"></div>
            <div class="col-sm-4 form-group">
                <label class="input-title" for="city">Unidade Jurisdicionada</label>
                <select class="form-control" id="city" name="city" {% if user_request=="POST" %}
                    onchange="document.getElementById('apply').click()" {% endif %}>
                    {% for city in options_city %}
                    <option value="{{ city }}" {% if selected_city==city %} selected {% endif %}>{{
                        city }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col"></div>
        </div>

        {% if user_request == "GET" %}
        <div class="text-center">
            <button class="btn btn-default btn-md button-style" type="submit" name="action" value="apply"
                id="apply">Aplicar</button>
        </div>
        {% elif user_request == "POST" %}
        <div class="text-center hidden">
            <button class="btn btn-default btn-md button-style" type="submit" name="action" value="apply"
                id="apply">Aplicar</button>
        </div>
        {% endif %}
    </form>

    <br>

    {% if user_request == "POST" %}
    <div class="table-responsive">
        <table class="table" style="width: 50%; margin-left: auto; margin-right: auto;">
            <thead>
                <tr scope="col">
                    {% for col in cols_general_description%}
                    <th>{{col}}</th>
                    {% endfor %}
                </tr>
            </thead>

            <tbody>
                <tr>
                    {% for attr in rows_general_description%}
                    <td>{{attr}}</td>
                    {% endfor %}
                </tr>
            </tbody>
        </table>
    </div>

    <div class="table-responsive">
        <table class="table table-hover matching-table">

            <thead>
                <tr scope="col">
                    {% for col in cols %}
                    <th>{{col}}</th>
                    {% endfor %}
                </tr>
            </thead>

            <tbody>
                {% for idx, row in enumerate(rows) %}
                <tr value={{idx}} style="cursor: pointer;">
                    {% for attr in row %}
                    <td>{{attr}}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>

        </table>
    </div>

    <br>

    <!-- <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-window"
        style="display: none;" id="modal-button"></button>

    <div class="modal fade" id="modal-window">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title">Pagamentos</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">

                </div>

            </div>
        </div>
    </div>

    <script>
        $(".table-hover").on("click", "tbody tr", function () {
            $(".modal-body").empty();

            var rowIdx = $(this)[0].attributes.value;

            var data = {{ modal | safe}}[rowIdx];

            console.log(data);
        });
    </script> -->
    {% endif %}

</div>

<script>
    $(document).ready(function () {
        $('.matching-table').DataTable({
            searching: false,
            language: {
                url: 'https://cdn.datatables.net/plug-ins/1.13.1/i18n/pt-BR.json'
            },
            columnDefs: [
                { orderable: true, className: 'reorder', targets: [1] },
                { orderable: false, targets: '_all' }
            ]
        });
    });
</script>

{% endblock %}