{% extends "layout.html" %} {% block body %}

<h1 class="title section-title">{{page_title}}</h1>

<div class="container">

    <hr>

    <iframe class="map col-lg-12 col-md-12 col-sm-12 col-12 .col-xl-12" height="400" src="/payment_queues_map"></iframe>

    <form method="post">
        <div class="row">
            <div class="col"></div>
            <div class="col-sm-4 form-group">
                <label class="input-title" for="city">Unidade Jurisdicionada</label>
                <select class="form-control" id="city" name="city">
                    {% for city in city_options %}
                    <option value="{{ city }}" {% if selected_city==city %} selected {% endif %}>{{ city }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col"></div>
        </div>

        <div class="col-md-12 text-center">
            <button class="btn btn-default btn-md button-style" name="action" value="apply"
                type="submit">Aplicar</button>
        </div>

        <br>

        {% if user_request == "POST" %}

        <div class="row">
            <div class="col-6 form-group">
                <label class="input-title" for="source">Fonte</label>
                <select class="form-control" id="source" name="source"
                    onchange="document.getElementById('update').click()">
                    {% for source in sources %}
                    <option value="{{ source }}" {% if selected_source==source %} selected {% endif %}>{{
                        source }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-6 form-group">
                <label class="input-title" for="day">Dias de Tolerância</label>
                <select class="form-control" id="day" name="day"
                    onchange="document.getElementById('update').click()">
                    {% for day in days_of_tolerance %}
                    <option value="{{ day }}" {% if selected_day==day %} selected {% endif %}>{{
                        day }}
                    </option>
                    {% endfor %}
                </select>
            </div>
        </div>
</div>

<div class="text-center hidden">
    <button class="btn btn-default btn-md button-style" type="submit" name="action" value="update"
        id="update">Atualizar</button>
</div>

<br>
{% endif %}

</form>


{% if show_table %}
<div class="row">
    <div class="col"></div>
    <div class="col">
        <div class="card" style="width: 18rem;">
            <div class="card-body">
              <!-- <h5 class="card-title">Resultado</h5> -->
              <!-- <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6> -->
              <h7>A pontuação da consulta foi <strong>{{ score }}</strong>.</h7>
            </div>
          </div>
    </div>
    <div class="col"></div>
</div>
<hr>
<!-- <table class="table table-hover"> -->
<table class="table fila-table table-striped table-bordered table-sm" cellspacing="0" width="100%">

    <thead>
        <tr scope="col">
            {% for col in columns %}
            <th>{{ col }}</th>
            {% endfor %}
        </tr>
    </thead>

    <tbody>
        {% for k in rows %}
        {% for i in k[5] %}

        <tr>
            <td> {{ i[0] }} </td>
            <td> {{ i[1] }} </td>
            <td> {{ i[2] }} </td>
            <td> {{ i[3] }} </td>
            <td> {{ k[1].strftime("%Y-%m-%d") }} </td>
            <td> {{ k[2].strftime("%Y-%m-%d") }} </td>
            <td> {% if k[4] != 0 %} {{ k[4] }} {% else: %} 0 {% endif %}</td>
        </tr>

        {% endfor %}
        {% endfor %}
    </tbody>

</table>
<br>
{% endif %}

</div>

{% endblock %}